<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automation & Logic | AirPure Intelligent</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;500;600;700&family=Inter:wght@400;600&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="automation.css">
</head>

<body class="auto-body">
    <div id="navbar-placeholder"></div>
    <script src="js/navbar-loader.js"></script>

    <!-- Header -->
    <header class="auto-header">
        <div class="header-brand">
            <i class="fas fa-robot"></i>
            <div>
                <h1>SMART AUTOMATION ENGINE</h1>
                <span class="subtitle">Logic Controller: ACTIVE</span>
            </div>
        </div>

        <div class="header-status">
            <div class="status-indicator enabled" id="automationStatus">
                <span class="label">AUTOMATION</span>
                <span class="value">ENABLED</span>
            </div>

            <div class="last-exec">
                <i class="fas fa-bolt"></i>
                <div>
                    <span class="label">LAST EXECUTION</span>
                    <span class="value" id="lastExecTime">--:--:--</span>
                </div>
            </div>

            <a href="index.html" class="btn-close"><i class="fas fa-times"></i></a>
        </div>
    </header>

    <main class="auto-grid">

        <!-- Top Toolbar -->
        <section class="toolbar-panel">
            <div class="master-toggle-container">
                <span class="toggle-label">MASTER ENABLE</span>
                <label class="toggle-switch large">
                    <input type="checkbox" id="masterAutoToggle" checked>
                    <span class="slider"></span>
                </label>
            </div>

            <div class="mode-cards">
                <div class="mode-card active" onclick="activateMode('smart-air', this)">
                    <i class="fas fa-wind"></i>
                    <span>Smart Air</span>
                </div>
                <div class="mode-card" onclick="activateMode('fire-safety', this)">
                    <i class="fas fa-fire-extinguisher"></i>
                    <span>Fire Safety</span>
                </div>
                <div class="mode-card" onclick="activateMode('night-mode', this)">
                    <i class="fas fa-moon"></i>
                    <span>Night Guard</span>
                </div>
                <div class="mode-card" onclick="activateMode('energy-save', this)">
                    <i class="fas fa-leaf"></i>
                    <span>Eco Mode</span>
                </div>
            </div>
        </section>

        <!-- Rule Builder -->
        <section class="panel rule-builder">
            <div class="panel-head">
                <h3><i class="fas fa-project-diagram"></i> RULE BUILDER</h3>
                <span class="badge" id="ruleCount">0 Rules Active</span>
            </div>

            <div class="builder-interface">
                <!-- Input Row -->
                <div class="logic-row">
                    <div class="logic-group">
                        <span class="logic-tag if">IF</span>
                        <select class="control-select" id="newCondition">
                            <option value="aqi">AQI Level</option>
                            <option value="temp">Temperature</option>
                            <option value="smoke">Smoke Detected</option>
                            <option value="gas">Gas Leak</option>
                            <option value="time">Time of Day</option>
                        </select>
                    </div>

                    <div class="logic-group condition-inputs" id="conditionInputs">
                        <select class="control-select tiny" id="newOperator">
                            <option value=">">Greater Than</option>
                            <option value="<">Less Than</option>
                            <option value="=">Equals</option>
                        </select>
                        <input type="number" class="control-input" id="newThreshold" placeholder="Value">
                    </div>

                    <div class="logic-group">
                        <span class="logic-tag then">THEN</span>
                        <select class="control-select" id="newAction">
                            <option value="purifier_on">Purifier: ON</option>
                            <option value="purifier_max">Purifier: MAX</option>
                            <option value="alarm_on">Alarm: ACTIVATE</option>
                            <option value="notify">Send Notification</option>
                        </select>
                    </div>

                    <button class="btn-add-rule" onclick="addNewRule()"><i class="fas fa-plus"></i> ADD</button>
                </div>

                <!-- Rules List -->
                <div class="rules-container" id="rulesList">
                    <!-- Rules injected by JS -->
                </div>
            </div>
        </section>

        <!-- Simulator & Logs -->
        <section class="panel simulator-panel">
            <div class="panel-head">
                <h3><i class="fas fa-microchip"></i> REAL-TIME SIMULATOR</h3>
                <button class="btn-sm" onclick="clearLogs()">Clear Logs</button>
            </div>

            <div class="sim-visuals">
                <div class="sensor-node" id="simAQI">
                    <span class="label">AQI</span>
                    <span class="val">45</span>
                </div>
                <div class="sensor-node" id="simTemp">
                    <span class="label">TEMP</span>
                    <span class="val">24Â°C</span>
                </div>
                <div class="sensor-node danger" id="simSmoke">
                    <span class="label">SMOKE</span>
                    <span class="val">NONE</span>
                </div>
            </div>

            <div class="sim-controls">
                <span>Inject Test Data:</span>
                <button class="btn-test" onclick="simulateEvent('high_aqi')">High AQI</button>
                <button class="btn-test" onclick="simulateEvent('fire')">Fire Event</button>
                <button class="btn-test" onclick="simulateEvent('normal')">Normalize</button>
            </div>

            <div class="console-log" id="consoleLog">
                <div class="log-entry system">System Online. Waiting for triggers...</div>
            </div>
        </section>

        <!-- Constraints Footer -->
        <section class="constraints-panel">
            <div class="constraint-item">
                <i class="fas fa-lock"></i>
                <span>Hard-Lock: Emergency Shutdown overrides all automation.</span>
            </div>
            <div class="action-buttons">
                <button class="btn-footer" onclick="saveRules()"><i class="fas fa-save"></i> Save Rules</button>
                <button class="btn-footer secondary" onclick="resetRules()"><i class="fas fa-undo"></i> Reset</button>
            </div>
        </section>

    </main>

    <div id="toast" class="toast hidden">Settings Saved</div>

    <script src="automation.js"></script>
</body>

</html>