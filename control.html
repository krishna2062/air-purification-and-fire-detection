<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Control Panel | AirPure Industrial</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Inter:wght@400;600&display=swap"
        rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Styles -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="control.css">
</head>

<body class="control-body">
    <div id="navbar-placeholder"></div>
    <script src="js/navbar-loader.js"></script>

    <!-- Header -->
    <header class="control-header">
        <div class="header-brand">
            <i class="fas fa-cogs fa-spin-hover"></i>
            <div>
                <h1>SYSTEM CONFIGURATION PANEL</h1>
                <span class="subtitle">MASTER CONTROL UNIT: MCU-01</span>
            </div>
        </div>

        <div class="header-status">
            <div class="status-indicator normal" id="systemModeIndicator">
                <span class="mode-label">SYSTEM MODE</span>
                <span class="mode-value">NORMAL OPERATION</span>
            </div>

            <div class="user-role admin">
                <i class="fas fa-user-shield"></i>
                <div>
                    <span class="role-label">ACCESS LEVEL</span>
                    <span class="role-value">ADMINISTRATOR</span>
                </div>
            </div>

            <div class="last-update">
                <span>Last Config Update:</span>
                <span id="lastUpdateTs">Just now</span>
            </div>

            <a href="index.html" class="btn-close"><i class="fas fa-times"></i></a>
        </div>
    </header>

    <main class="control-grid">

        <!-- LEFT COLUMN: DEVICE & SENSORS -->
        <div class="grid-col left-col">

            <!-- Air Control Module -->
            <section class="panel control-panel-air">
                <div class="panel-head">
                    <h3><i class="fas fa-fan"></i> AIR PURIFICATION CONTROL</h3>
                    <label class="toggle-switch">
                        <input type="checkbox" id="masterPower" checked>
                        <span class="slider"></span>
                    </label>
                </div>

                <div class="panel-content">
                    <div class="control-row">
                        <span class="label">Operation Mode</span>
                        <div class="mode-selector" id="opMode">
                            <button class="mode-btn active" data-mode="auto">AUTO</button>
                            <button class="mode-btn" data-mode="manual">MANUAL</button>
                            <button class="mode-btn" data-mode="eco">ECO</button>
                        </div>
                    </div>

                    <div class="control-row" id="fanControlRow">
                        <span class="label">Fan Speed</span>
                        <div class="range-wrapper">
                            <input type="range" class="control-range" min="0" max="100" value="45" id="fanSpeed"
                                disabled>
                            <span class="range-val" id="fanSpeedVal">45%</span>
                        </div>
                    </div>

                    <div class="control-row">
                        <span class="label">Filter Boost <i class="fas fa-info-circle tooltip-icon"
                                title="Increases pressure for 15 mins"></i></span>
                        <label class="toggle-switch small">
                            <input type="checkbox" id="filterBoost">
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="control-row">
                        <span class="label">Silent / Night Mode</span>
                        <label class="toggle-switch small">
                            <input type="checkbox" id="silentMode">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </section>

            <!-- Fire Config Module -->
            <section class="panel config-panel-fire">
                <div class="panel-head">
                    <h3><i class="fas fa-fire-extinguisher"></i> FIRE DETECTION CONFIG</h3>
                    <div class="status-dot active" title="Sensors Online"></div>
                </div>

                <div class="panel-content">
                    <h4 class="sub-head">Threshold Calibration</h4>

                    <div class="config-item">
                        <div class="config-label">
                            <span>Smoke Sensitivity</span>
                            <span class="unit">(Obscuration %)</span>
                        </div>
                        <div class="range-wrapper">
                            <input type="range" class="control-range danger" min="1" max="10" value="5" id="smokeSens">
                            <span class="range-val" id="smokeSensVal">5%</span>
                        </div>
                    </div>

                    <div class="config-item">
                        <div class="config-label">
                            <span>Max Temp Rise</span>
                            <span class="unit">(Â°C / min)</span>
                        </div>
                        <div class="input-wrapper">
                            <input type="number" class="control-input" value="8" min="2" max="20" id="tempRise">
                            <button class="btn-set" onclick="updateConfig('tempRise')">SET</button>
                        </div>
                    </div>

                    <div class="separator"></div>

                    <div class="control-row">
                        <span class="label">Flame Detection Enabled</span>
                        <label class="toggle-switch small danger">
                            <input type="checkbox" checked id="flameEnable">
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="control-row">
                        <span class="label">Auto-Ventilation on Alarm</span>
                        <label class="toggle-switch small danger">
                            <input type="checkbox" checked id="autoVent">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </section>

        </div>

        <!-- RIGHT COLUMN: SAFETY & RULES -->
        <div class="grid-col right-col">

            <!-- Emergency Safety Override -->
            <section class="panel safety-panel">
                <div class="panel-head danger-bg">
                    <h3><i class="fas fa-exclamation-triangle"></i> EMERGENCY OVERRIDE</h3>
                </div>

                <div class="panel-content center-align">
                    <p class="warning-text">CAUTION: MANUAL OVERRIDES BYPASS SENSOR LOGIC</p>

                    <div class="emergency-buttons">
                        <div class="hold-button-container">
                            <button class="btn-emergency btn-shutdown" id="btnShutdown" onmousedown="startHold(this)"
                                onmouseup="endHold(this)" onmouseleave="endHold(this)">
                                <i class="fas fa-power-off"></i>
                                <span>EMERGENCY<br>SHUTDOWN</span>
                            </button>
                            <svg class="progress-ring" width="100" height="100">
                                <circle class="progress-ring-circle" stroke="white" stroke-width="4" fill="transparent"
                                    r="45" cx="50" cy="50" />
                            </svg>
                        </div>

                        <button class="btn-emergency btn-evacuate" onclick="triggerEvacuation()">
                            <i class="fas fa-bullhorn"></i>
                            <span>TRIGGER<br>EVACUATION</span>
                        </button>
                    </div>

                    <div class="emergency-actions">
                        <button class="btn-action" onclick="resetSystem()">
                            <i class="fas fa-undo"></i> RESET SYSTEM
                        </button>
                        <button class="btn-action warning" onclick="testAlarm()">
                            <i class="fas fa-bell"></i> TEST ALARM
                        </button>
                    </div>
                </div>
            </section>

            <!-- Automation Rules -->
            <section class="panel rules-panel">
                <div class="panel-head">
                    <h3><i class="fas fa-project-diagram"></i> AUTOMATION RULES</h3>
                    <button class="btn-add" onclick="addRule()"><i class="fas fa-plus"></i></button>
                </div>

                <div class="panel-content rules-list" id="rulesList">
                    <!-- Default Rules -->
                    <div class="rule-item active">
                        <div class="rule-info">
                            <span class="rule-logic">IF <span class="tag">AQI > 150</span> THEN <span
                                    class="tag action">PURIFIER MAX</span></span>
                        </div>
                        <label class="toggle-switch tiny">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>

                    <div class="rule-item active">
                        <div class="rule-info">
                            <span class="rule-logic">IF <span class="tag">SMOKE DETECTED</span> THEN <span
                                    class="tag action danger">ALARM ON</span></span>
                        </div>
                        <label class="toggle-switch tiny danger">
                            <input type="checkbox" checked disabled>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>

                <div class="panel-footer">
                    <div class="status-text" id="configStatus"><i class="fas fa-check"></i> All rules active</div>
                </div>
            </section>

        </div>

        <!-- FULL WIDTH: ACTION BAR -->
        <section class="action-bar-panel">
            <div class="config-summary">
                <span><i class="fas fa-clipboard-check"></i> Changes waiting: <b id="changeCount">0</b></span>
            </div>
            <div class="action-buttons">
                <button class="btn-footer secondary" onclick="location.reload()">Discard Changes</button>
                <button class="btn-footer primary" onclick="saveConfiguration()">
                    <i class="fas fa-save"></i> Save & Apply
                </button>
            </div>
        </section>

    </main>

    <!-- Confirmation Modal -->
    <div class="modal-overlay" id="confirmModal">
        <div class="modal-card">
            <div class="modal-header warning">
                <h3><i class="fas fa-exclamation-circle"></i> Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="confirmMsg">Are you sure?</p>
            </div>
            <div class="modal-footer">
                <button class="btn-footer secondary" onclick="closeConfirm()">Cancel</button>
                <button class="btn-footer primary warning" id="confirmBtn">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="toast hidden">Configuration Saved Successfully</div>

    <script src="control.js"></script>
</body>

</html>